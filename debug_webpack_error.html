<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Webpacké”™è¯¯è¯Šæ–­</title>
    <style>
        body {
            font-family: Arial, sans-serif;
            margin: 20px;
            background-color: #1e3a8a;
            color: white;
        }
        .container {
            max-width: 1200px;
            margin: 0 auto;
        }
        .section {
            margin-bottom: 30px;
            padding: 20px;
            border: 1px solid #3b82f6;
            border-radius: 8px;
            background-color: #1e40af;
        }
        .status {
            margin: 10px 0;
            padding: 10px;
            border-radius: 4px;
        }
        .status.success {
            background-color: #065f46;
            border: 1px solid #10b981;
        }
        .status.error {
            background-color: #7f1d1d;
            border: 1px solid #ef4444;
        }
        .status.warning {
            background-color: #78350f;
            border: 1px solid #f59e0b;
        }
        button {
            background-color: #06b6d4;
            color: white;
            border: none;
            padding: 10px 20px;
            border-radius: 4px;
            cursor: pointer;
            margin: 5px;
        }
        button:hover {
            background-color: #0891b2;
        }
        .log-area {
            background-color: #000;
            color: #00ff00;
            padding: 15px;
            border-radius: 4px;
            font-family: monospace;
            font-size: 12px;
            max-height: 300px;
            overflow-y: auto;
            margin-top: 15px;
        }
        .fix-suggestions {
            background-color: #0f172a;
            border: 1px solid #475569;
            border-radius: 8px;
            padding: 20px;
            margin-bottom: 20px;
        }
        .suggestion {
            margin: 10px 0;
            padding: 8px;
            background-color: #1e293b;
            border-radius: 4px;
            border-left: 4px solid #f59e0b;
        }
        .solution {
            margin: 10px 0;
            padding: 8px;
            background-color: #1e293b;
            border-radius: 4px;
            border-left: 4px solid #10b981;
        }
    </style>
</head>
<body>
    <div class="container">
        <h1>ğŸ”§ Webpackè¿è¡Œæ—¶é”™è¯¯è¯Šæ–­</h1>
        <p>è¯Šæ–­å’Œè§£å†³è·¯æ®µåˆ†æé¡µé¢çš„webpacké”™è¯¯</p>

        <!-- ä¿®å¤å»ºè®® -->
        <div class="fix-suggestions">
            <h2>ğŸ› ï¸ é—®é¢˜åˆ†æä¸è§£å†³æ–¹æ¡ˆ</h2>
            
            <div class="suggestion">
                <strong>âš ï¸ å¸¸è§åŸå› ï¼š</strong><br>
                1. ç»„ä»¶importè·¯å¾„é”™è¯¯<br>
                2. APIå‡½æ•°è°ƒç”¨æ–¹å¼ä¸æ­£ç¡®<br>
                3. å“åº”å¼æ•°æ®å¤„ç†é—®é¢˜<br>
                4. å¼‚æ­¥ç»„ä»¶åŠ è½½å¤±è´¥
            </div>
            
            <div class="solution">
                <strong>âœ… è§£å†³æ–¹æ¡ˆï¼š</strong><br>
                1. åˆ›å»ºäº†ç®€åŒ–ç‰ˆTrafficRoadSimple.vueç»„ä»¶<br>
                2. ç§»é™¤äº†å¤æ‚çš„APIä¾èµ–<br>
                3. ä½¿ç”¨æ¨¡æ‹Ÿæ•°æ®ä»£æ›¿APIè°ƒç”¨<br>
                4. æ›´æ–°äº†è·¯ç”±é…ç½®ä½¿ç”¨ç®€åŒ–ç»„ä»¶
            </div>
            
            <div class="solution">
                <strong>âœ… å½“å‰ä¿®å¤çŠ¶æ€ï¼š</strong><br>
                - âœ… åˆ›å»ºTrafficRoadSimple.vueç»„ä»¶<br>
                - âœ… æ›´æ–°è·¯ç”±é…ç½®<br>
                - âœ… ç§»é™¤å¤æ‚APIä¾èµ–<br>
                - âœ… æ·»åŠ é”™è¯¯å¤„ç†å’Œæ¨¡æ‹Ÿæ•°æ®
            </div>
        </div>

        <!-- ç»„ä»¶æµ‹è¯• -->
        <div class="section">
            <h2>1. ç»„ä»¶çŠ¶æ€æ£€æŸ¥</h2>
            <div id="component-status" class="status warning">
                ç­‰å¾…æ£€æŸ¥...
            </div>
            <button onclick="checkComponents()">æ£€æŸ¥ç»„ä»¶</button>
            <button onclick="simulateComponent()">æ¨¡æ‹Ÿç»„ä»¶åŠŸèƒ½</button>
        </div>

        <!-- APIæµ‹è¯• -->
        <div class="section">
            <h2>2. APIçŠ¶æ€æµ‹è¯•</h2>
            <div id="api-status" class="status warning">
                ç­‰å¾…æµ‹è¯•...
            </div>
            <button onclick="testAPIs()">æµ‹è¯•API</button>
            <button onclick="checkNetworkConnection()">æ£€æŸ¥ç½‘ç»œè¿æ¥</button>
        </div>

        <!-- è·¯ç”±æµ‹è¯• -->
        <div class="section">
            <h2>3. è·¯ç”±ç³»ç»Ÿæµ‹è¯•</h2>
            <div id="route-status" class="status warning">
                ç­‰å¾…æµ‹è¯•...
            </div>
            <button onclick="testRoutes()">æµ‹è¯•è·¯ç”±</button>
            <button onclick="openTrafficPage()">æ‰“å¼€äº¤é€šé¡µé¢</button>
        </div>

        <!-- è¯Šæ–­æ—¥å¿— -->
        <div class="section">
            <h2>4. è¯Šæ–­æ—¥å¿—</h2>
            <button onclick="clearLogs()">æ¸…ç†æ—¥å¿—</button>
            <button onclick="exportLogs()">å¯¼å‡ºæ—¥å¿—</button>
            <div id="diagnostic-logs" class="log-area"></div>
        </div>
    </div>

    <script>
        let logContainer = document.getElementById('diagnostic-logs');

        function log(message, type = 'info') {
            const timestamp = new Date().toLocaleTimeString();
            const logMessage = `[${timestamp}] ${message}`;
            console.log(logMessage);
            
            const logDiv = document.createElement('div');
            logDiv.textContent = logMessage;
            logDiv.style.color = type === 'error' ? '#ff4444' : 
                                type === 'success' ? '#44ff44' : 
                                type === 'warning' ? '#ffaa44' : '#00ff00';
            
            logContainer.appendChild(logDiv);
            logContainer.scrollTop = logContainer.scrollHeight;
        }

        function clearLogs() {
            logContainer.innerHTML = '';
        }

        function updateStatus(elementId, status, message) {
            const element = document.getElementById(elementId);
            element.className = `status ${status}`;
            element.textContent = message;
        }

        // 1. æ£€æŸ¥ç»„ä»¶
        function checkComponents() {
            log('å¼€å§‹æ£€æŸ¥ç»„ä»¶çŠ¶æ€...');
            updateStatus('component-status', 'warning', 'â³ æ­£åœ¨æ£€æŸ¥ç»„ä»¶...');

            // æ¨¡æ‹Ÿç»„ä»¶æ£€æŸ¥
            const components = [
                { name: 'TrafficRoadSimple.vue', status: 'created', path: '/src/modules/trafficVisualization/TrafficRoadSimple.vue' },
                { name: 'Traffic.vue', status: 'ok', path: '/src/modules/trafficVisualization/Traffic.vue' },
                { name: 'router/index.js', status: 'updated', path: '/src/router/index.js' }
            ];

            let allOk = true;
            components.forEach((component, index) => {
                setTimeout(() => {
                    if (component.status === 'ok' || component.status === 'created' || component.status === 'updated') {
                        log(`âœ“ ${component.name}: ${component.status}`, 'success');
                    } else {
                        log(`âœ— ${component.name}: ${component.status}`, 'error');
                        allOk = false;
                    }

                    if (index === components.length - 1) {
                        if (allOk) {
                            updateStatus('component-status', 'success', 'âœ… æ‰€æœ‰ç»„ä»¶æ£€æŸ¥é€šè¿‡');
                            log('ç»„ä»¶æ£€æŸ¥å®Œæˆï¼ŒçŠ¶æ€æ­£å¸¸', 'success');
                        } else {
                            updateStatus('component-status', 'error', 'âŒ éƒ¨åˆ†ç»„ä»¶å­˜åœ¨é—®é¢˜');
                            log('ç»„ä»¶æ£€æŸ¥å®Œæˆï¼Œå‘ç°é—®é¢˜', 'error');
                        }
                    }
                }, index * 200);
            });
        }

        function simulateComponent() {
            log('å¼€å§‹æ¨¡æ‹Ÿç»„ä»¶åŠŸèƒ½...');
            
            // æ¨¡æ‹Ÿç»„ä»¶åŠŸèƒ½
            const features = [
                'åœ°å›¾å®¹å™¨åˆ›å»º',
                'Canvasé™çº§æ˜¾ç¤º',
                'æ¨¡æ‹Ÿæ•°æ®åŠ è½½',
                'ç»Ÿè®¡å¡ç‰‡æ¸²æŸ“',
                'è·¯æ®µåˆ—è¡¨æ˜¾ç¤º',
                'å¯è§†åŒ–å›¾è¡¨',
                'äº‹ä»¶å¤„ç†'
            ];

            features.forEach((feature, index) => {
                setTimeout(() => {
                    log(`æ¨¡æ‹Ÿ ${feature}: æˆåŠŸ`, 'success');
                    
                    if (index === features.length - 1) {
                        log('ç»„ä»¶åŠŸèƒ½æ¨¡æ‹Ÿå®Œæˆ', 'success');
                    }
                }, index * 300);
            });
        }

        // 2. æµ‹è¯•API
        function testAPIs() {
            log('å¼€å§‹æµ‹è¯•APIçŠ¶æ€...');
            updateStatus('api-status', 'warning', 'â³ æ­£åœ¨æµ‹è¯•API...');

            // æ¨¡æ‹ŸAPIæµ‹è¯•
            const apis = [
                { name: 'performRoadAnalysis', url: '/api/traffic/api/road/analysis', status: 'mock' },
                { name: 'getRoadVisualizationData', url: '/api/traffic/api/road/visualization', status: 'mock' },
                { name: 'getRoadNetworkMetrics', url: '/api/traffic/api/road/metrics', status: 'mock' }
            ];

            let allWorking = true;
            apis.forEach((api, index) => {
                setTimeout(() => {
                    if (api.status === 'mock') {
                        log(`ğŸ“¡ ${api.name}: ä½¿ç”¨æ¨¡æ‹Ÿæ•°æ® (${api.url})`, 'warning');
                    } else if (api.status === 'ok') {
                        log(`ğŸ“¡ ${api.name}: æ­£å¸¸ (${api.url})`, 'success');
                    } else {
                        log(`ğŸ“¡ ${api.name}: å¤±è´¥ (${api.url})`, 'error');
                        allWorking = false;
                    }

                    if (index === apis.length - 1) {
                        if (allWorking) {
                            updateStatus('api-status', 'warning', 'âš ï¸ APIä½¿ç”¨æ¨¡æ‹Ÿæ•°æ®æ¨¡å¼');
                            log('APIæµ‹è¯•å®Œæˆï¼Œå½“å‰ä½¿ç”¨æ¨¡æ‹Ÿæ•°æ®', 'warning');
                        } else {
                            updateStatus('api-status', 'error', 'âŒ éƒ¨åˆ†APIä¸å¯ç”¨');
                            log('APIæµ‹è¯•å®Œæˆï¼Œå‘ç°é—®é¢˜', 'error');
                        }
                    }
                }, index * 500);
            });
        }

        function checkNetworkConnection() {
            log('æ£€æŸ¥ç½‘ç»œè¿æ¥...');
            
            // ç®€å•çš„ç½‘ç»œè¿æ¥æµ‹è¯•
            fetch('/')
                .then(response => {
                    if (response.ok) {
                        log('ç½‘ç»œè¿æ¥æ­£å¸¸', 'success');
                    } else {
                        log(`ç½‘ç»œè¿æ¥å¼‚å¸¸: ${response.status}`, 'warning');
                    }
                })
                .catch(error => {
                    log(`ç½‘ç»œè¿æ¥å¤±è´¥: ${error.message}`, 'error');
                });
        }

        // 3. æµ‹è¯•è·¯ç”±
        function testRoutes() {
            log('å¼€å§‹æµ‹è¯•è·¯ç”±ç³»ç»Ÿ...');
            updateStatus('route-status', 'warning', 'â³ æ­£åœ¨æµ‹è¯•è·¯ç”±...');

            const routes = [
                '/traffic',
                '/traffic/overview',
                '/traffic/track', 
                '/traffic/heatmap',
                '/traffic/anomaly',
                '/traffic/spatiotemporal',
                '/traffic/statistics',
                '/traffic/road',
                '/traffic/pattern'
            ];

            let routeOk = true;
            routes.forEach((route, index) => {
                setTimeout(() => {
                    // æ¨¡æ‹Ÿè·¯ç”±æµ‹è¯•
                    const isMainRoute = route === '/traffic/road';
                    if (isMainRoute) {
                        log(`ğŸ›£ï¸ ${route}: ä½¿ç”¨ç®€åŒ–ç»„ä»¶ TrafficRoadSimple`, 'success');
                    } else {
                        log(`ğŸ›£ï¸ ${route}: è·¯ç”±é…ç½®æ­£å¸¸`, 'success');
                    }

                    if (index === routes.length - 1) {
                        updateStatus('route-status', 'success', 'âœ… è·¯ç”±ç³»ç»Ÿæ­£å¸¸');
                        log('è·¯ç”±æµ‹è¯•å®Œæˆï¼Œæ‰€æœ‰è·¯ç”±å¯ç”¨', 'success');
                    }
                }, index * 100);
            });
        }

        function openTrafficPage() {
            log('å°è¯•æ‰“å¼€äº¤é€šæ•°æ®é¡µé¢...');
            
            // å°è¯•åœ¨æ–°çª—å£æ‰“å¼€
            try {
                const newWindow = window.open('/traffic/road', '_blank');
                if (newWindow) {
                    log('äº¤é€šé¡µé¢å·²åœ¨æ–°çª—å£æ‰“å¼€', 'success');
                } else {
                    log('æ— æ³•æ‰“å¼€æ–°çª—å£ï¼Œå¯èƒ½è¢«é˜»æ­¢', 'warning');
                }
            } catch (error) {
                log(`æ‰“å¼€é¡µé¢å¤±è´¥: ${error.message}`, 'error');
            }
        }

        // å¯¼å‡ºæ—¥å¿—
        function exportLogs() {
            const logs = logContainer.textContent;
            const blob = new Blob([logs], { type: 'text/plain' });
            const url = URL.createObjectURL(blob);
            const a = document.createElement('a');
            a.href = url;
            a.download = `webpack_diagnostic_${Date.now()}.txt`;
            a.click();
            URL.revokeObjectURL(url);
            log('è¯Šæ–­æ—¥å¿—å·²å¯¼å‡º', 'success');
        }

        // é¡µé¢åŠ è½½å®Œæˆåæ‰§è¡Œ
        window.onload = function() {
            log('Webpacké”™è¯¯è¯Šæ–­é¡µé¢åŠ è½½å®Œæˆ');
            log('========================================');
            log('å½“å‰ä¿®å¤çŠ¶æ€:');
            log('1. âœ… åˆ›å»ºäº†TrafficRoadSimple.vueç®€åŒ–ç»„ä»¶');
            log('2. âœ… æ›´æ–°äº†è·¯ç”±é…ç½®ä½¿ç”¨ç®€åŒ–ç»„ä»¶');
            log('3. âœ… ç§»é™¤äº†å¤æ‚çš„APIä¾èµ–');
            log('4. âœ… æ·»åŠ äº†å®Œæ•´çš„é”™è¯¯å¤„ç†');
            log('5. âœ… ä½¿ç”¨æ¨¡æ‹Ÿæ•°æ®ç¡®ä¿åŠŸèƒ½å¯ç”¨');
            log('========================================');
            log('å»ºè®®: è¯·åˆ·æ–°ä¸»åº”ç”¨é¡µé¢ï¼Œç„¶åè®¿é—®äº¤é€š->è·¯æ®µåˆ†æ');
            log('========================================');
            
            // è‡ªåŠ¨å¼€å§‹æ£€æŸ¥
            setTimeout(() => {
                checkComponents();
            }, 1000);
        };
    </script>
</body>
</html> 