<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>å¯¼èˆªåˆ‡æ¢æµ‹è¯•é¡µé¢</title>
    <style>
        body {
            font-family: Arial, sans-serif;
            margin: 20px;
            background: #f0f2f5;
        }
        .test-container {
            max-width: 800px;
            margin: 0 auto;
            background: white;
            padding: 20px;
            border-radius: 8px;
            box-shadow: 0 2px 8px rgba(0,0,0,0.1);
        }
        .nav-test {
            margin: 20px 0;
            padding: 20px;
            border: 1px solid #ddd;
            border-radius: 6px;
            background: #f9f9f9;
        }
        .status {
            margin: 10px 0;
            padding: 10px;
            border-radius: 4px;
        }
        .status.success {
            background: #d4edda;
            color: #155724;
            border: 1px solid #c3e6cb;
        }
        .status.error {
            background: #f8d7da;
            color: #721c24;
            border: 1px solid #f5c6cb;
        }
        .status.warning {
            background: #fff3cd;
            color: #856404;
            border: 1px solid #ffeaa7;
        }
        button {
            margin: 5px;
            padding: 8px 16px;
            background: #007bff;
            color: white;
            border: none;
            border-radius: 4px;
            cursor: pointer;
        }
        button:hover {
            background: #0056b3;
        }
        .console-output {
            background: #2d2d2d;
            color: #f8f8f2;
            padding: 15px;
            border-radius: 6px;
            font-family: 'Courier New', monospace;
            font-size: 12px;
            max-height: 300px;
            overflow-y: auto;
            margin: 10px 0;
        }
    </style>
</head>
<body>
    <div class="test-container">
        <h1>ğŸ”§ å¯¼èˆªåˆ‡æ¢Bugä¿®å¤éªŒè¯</h1>
        
        <div class="nav-test">
            <h3>é—®é¢˜æè¿°</h3>
            <p>ç”¨æˆ·åé¦ˆï¼šç‚¹å‡»äºŒçº§å¯¼èˆªåˆ°"æ•°æ®æ€»è§ˆ"åï¼Œæ— æ³•åˆ‡æ¢åˆ°å…¶ä»–é¡µé¢ï¼Œä¸”æ˜¾ç¤º"æ­£åœ¨åŠ è½½é«˜å¾·åœ°å›¾API"</p>
        </div>

        <div class="nav-test">
            <h3>ä¿®å¤å†…å®¹</h3>
            <ul>
                <li>âœ… åˆ›å»ºå…¨å±€åœ°å›¾APIç®¡ç†å™¨ (<code>mapManager.js</code>)</li>
                <li>âœ… é¿å…é‡å¤åŠ è½½é«˜å¾·åœ°å›¾API</li>
                <li>âœ… ä¿®å¤ç»„ä»¶åˆ‡æ¢æ—¶çš„æ¸…ç†é€»è¾‘</li>
                <li>âœ… æ·»åŠ å”¯ä¸€å›è°ƒå‡½æ•°åé¿å…å†²çª</li>
                <li>âœ… ä¼˜åŒ–ç»„ä»¶ç”Ÿå‘½å‘¨æœŸç®¡ç†</li>
                <li>âœ… æ·»åŠ å¼ºåˆ¶é‡æ–°æ¸²æŸ“æœºåˆ¶ (<code>:key="routeKey"</code>)</li>
            </ul>
        </div>

        <div class="nav-test">
            <h3>æµ‹è¯•è¯´æ˜</h3>
            <div class="status warning">
                <strong>æµ‹è¯•æ­¥éª¤ï¼š</strong>
                <ol>
                    <li>å¯åŠ¨å‰ç«¯å¼€å‘æœåŠ¡å™¨ï¼š<code>npm run dev</code></li>
                    <li>è®¿é—®äº¤é€šæ•°æ®é¡µé¢ï¼š<code>http://localhost:8082/traffic/overview</code></li>
                    <li>åˆ‡æ¢åˆ°"æ•°æ®æ€»è§ˆ"é¡µé¢</li>
                    <li>å°è¯•åˆ‡æ¢åˆ°å…¶ä»–é¡µé¢ï¼ˆè½¨è¿¹æŸ¥è¯¢ã€çƒ­åŠ›å›¾ç­‰ï¼‰</li>
                    <li>è§‚å¯Ÿæ˜¯å¦èƒ½æ­£å¸¸åˆ‡æ¢ï¼Œæ— å¡æ­»ç°è±¡</li>
                    <li>æ£€æŸ¥æµè§ˆå™¨æ§åˆ¶å°æ˜¯å¦æœ‰é”™è¯¯ä¿¡æ¯</li>
                </ol>
            </div>
        </div>

        <div class="nav-test">
            <h3>é¢„æœŸç»“æœ</h3>
            <div class="status success">
                <strong>ä¿®å¤ååº”è¯¥ï¼š</strong>
                <ul>
                    <li>âœ… é¡µé¢åˆ‡æ¢æµç•…ï¼Œæ— å¡æ­»ç°è±¡</li>
                    <li>âœ… åœ°å›¾APIåªåŠ è½½ä¸€æ¬¡</li>
                    <li>âœ… æ§åˆ¶å°æ— é‡å¤åŠ è½½è­¦å‘Š</li>
                    <li>âœ… ç»„ä»¶æ­£ç¡®æ¸…ç†ï¼Œæ— å†…å­˜æ³„æ¼</li>
                    <li>âœ… æ¯æ¬¡åˆ‡æ¢éƒ½èƒ½æ­£å¸¸æ˜¾ç¤ºå†…å®¹</li>
                </ul>
            </div>
        </div>

        <div class="nav-test">
            <h3>æŠ€æœ¯æ”¹è¿›è¯¦æƒ…</h3>
            <div class="console-output">
# 1. å…¨å±€APIç®¡ç†å™¨ (frontend/src/utils/mapManager.js)
- å•ä¾‹æ¨¡å¼ç®¡ç†åœ°å›¾APIåŠ è½½çŠ¶æ€
- é¿å…å¤šç»„ä»¶åŒæ—¶åŠ è½½APIå†²çª
- å”¯ä¸€å›è°ƒå‡½æ•°åé˜²æ­¢è¦†ç›–

# 2. ç»„ä»¶ä¼˜åŒ– (TrafficMapPanel.vue)
- æ”¹è¿›åœ°å›¾å®ä¾‹æ¸…ç†é€»è¾‘
- å¼‚æ­¥åŠ è½½å’Œæ¸…ç†é¿å…é˜»å¡
- æ›´å¥½çš„é”™è¯¯å¤„ç†å’ŒçŠ¶æ€ç®¡ç†

# 3. å¯¼èˆªä¼˜åŒ– (Traffic.vue) 
- æ·»åŠ  :key="routeKey" å¼ºåˆ¶é‡æ–°æ¸²æŸ“
- è·¯ç”±å˜åŒ–ç›‘å¬ç¡®ä¿ç»„ä»¶é‡æ–°åˆå§‹åŒ–

# 4. æ€§èƒ½ä¼˜åŒ–
- å‡å°‘åœ°å›¾åˆå§‹åŒ–å»¶è¿Ÿ
- ä¼˜åŒ–èµ„æºæ¸…ç†æµç¨‹
- æ·»åŠ è¯¦ç»†çš„æ—¥å¿—è·Ÿè¸ª
            </div>
        </div>

        <div class="nav-test">
            <h3>è°ƒè¯•å·¥å…·</h3>
            <button onclick="checkAMapStatus()">æ£€æŸ¥åœ°å›¾APIçŠ¶æ€</button>
            <button onclick="clearConsole()">æ¸…ç©ºæ§åˆ¶å°</button>
            <button onclick="simulateNavigation()">æ¨¡æ‹Ÿå¯¼èˆªåˆ‡æ¢</button>
            
            <div id="debug-output" class="console-output" style="margin-top: 10px;">
                æ§åˆ¶å°è¾“å‡ºå°†æ˜¾ç¤ºåœ¨è¿™é‡Œ...
            </div>
        </div>
    </div>

    <script>
        function checkAMapStatus() {
            const output = document.getElementById('debug-output');
            const status = {
                hasWindow: typeof window !== 'undefined',
                hasAMap: typeof window.AMap !== 'undefined',
                amapVersion: window.AMap ? window.AMap.version : 'N/A',
                timestamp: new Date().toLocaleTimeString()
            };
            
            output.innerHTML = `
ğŸ” åœ°å›¾APIçŠ¶æ€æ£€æŸ¥ [${status.timestamp}]
â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”
âœ… Windowå¯¹è±¡: ${status.hasWindow}
${status.hasAMap ? 'âœ…' : 'âŒ'} AMapå¯¹è±¡: ${status.hasAMap}
ğŸ“¦ AMapç‰ˆæœ¬: ${status.amapVersion}
â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”
            `;
        }
        
        function clearConsole() {
            document.getElementById('debug-output').innerHTML = 'æ§åˆ¶å°å·²æ¸…ç©º...';
        }
        
        function simulateNavigation() {
            const output = document.getElementById('debug-output');
            let step = 0;
            const steps = [
                'ğŸš€ å¼€å§‹æ¨¡æ‹Ÿå¯¼èˆªåˆ‡æ¢...',
                'ğŸ“„ åˆ‡æ¢åˆ°æ•°æ®æ€»è§ˆé¡µé¢',
                'ğŸ—ºï¸ åˆå§‹åŒ–åœ°å›¾ç»„ä»¶...',
                'ğŸ”„ åˆ‡æ¢åˆ°è½¨è¿¹æŸ¥è¯¢é¡µé¢',
                'ğŸ§¹ æ¸…ç†å‰ä¸€ä¸ªç»„ä»¶...',
                'âœ… å¯¼èˆªåˆ‡æ¢å®Œæˆï¼'
            ];
            
            const interval = setInterval(() => {
                if (step < steps.length) {
                    output.innerHTML += `\n[${new Date().toLocaleTimeString()}] ${steps[step]}`;
                    step++;
                } else {
                    clearInterval(interval);
                    output.innerHTML += '\nâ”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”';
                }
                output.scrollTop = output.scrollHeight;
            }, 800);
        }
        
        // è‡ªåŠ¨æ£€æŸ¥çŠ¶æ€
        window.onload = function() {
            setTimeout(() => {
                checkAMapStatus();
            }, 1000);
        };
    </script>
</body>
</html> 