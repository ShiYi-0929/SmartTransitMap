{"ast":null,"code":"import \"core-js/modules/es.array.push.js\";\nimport \"core-js/modules/es.iterator.constructor.js\";\nimport \"core-js/modules/es.iterator.filter.js\";\nimport \"core-js/modules/es.iterator.find.js\";\nimport \"core-js/modules/es.iterator.for-each.js\";\nimport \"core-js/modules/es.iterator.map.js\";\nimport \"core-js/modules/es.iterator.reduce.js\";\nimport \"core-js/modules/web.url-search-params.delete.js\";\nimport \"core-js/modules/web.url-search-params.has.js\";\nimport \"core-js/modules/web.url-search-params.size.js\";\nimport { ref, computed, onMounted, onUnmounted } from 'vue';\nimport { Route, Search, X, Play, Download } from 'lucide-vue-next';\nimport { getTrackData, getSampleVehicles } from '@/api/traffic';\n\n// 响应式数据\nconst minDate = \"2013-09-12T00:00\";\nconst maxDate = \"2013-09-18T23:59\";\n\n// 计算属性\n\nexport default {\n  __name: 'TrafficTrack',\n  setup(__props, {\n    expose: __expose\n  }) {\n    __expose();\n    const loading = ref(false);\n    const loadingSamples = ref(false);\n    const trackData = ref([]);\n    const selectedTrackDetails = ref(null);\n    const sampleVehicles = ref([]);\n    const queryParams = ref({\n      startTime: '2013-09-13T08:00',\n      endTime: '2013-09-13T12:00',\n      vehicleId: '',\n      mode: 'single',\n      detail: 'full',\n      speedFilter: ''\n    });\n    const displayOptions = ref({\n      showSpeed: true,\n      showTime: true,\n      showStops: false\n    });\n\n    // 地图相关\n    const mapContainerId = `track-map-${Date.now()}`;\n    let map = null;\n    let polylines = [];\n    let markers = [];\n\n    // 时间限制\n    const totalPoints = computed(() => {\n      return trackData.value.reduce((total, track) => {\n        return total + (track.points ? track.points.length : 0);\n      }, 0);\n    });\n    const trackStats = computed(() => {\n      if (trackData.value.length === 0) return [];\n\n      // 计算总距离和总时长\n      const totalDistance = trackData.value.reduce((sum, track) => {\n        // 使用后端计算的距离（单位：公里）\n        const distance = track.distance || 0;\n        return sum + distance;\n      }, 0);\n      const totalDuration = trackData.value.reduce((sum, track) => {\n        // 使用后端计算的时长（单位：秒）\n        const duration = track.duration || 0;\n        return sum + duration;\n      }, 0);\n\n      // 计算平均速度 (km/h)\n      const avgSpeed = totalDuration > 0 ? totalDistance / (totalDuration / 3600) : 0;\n      return [{\n        label: '轨迹数量',\n        value: trackData.value.length\n      }, {\n        label: '总距离',\n        value: formatDistance(totalDistance)\n      }, {\n        label: '总时长',\n        value: formatDuration(totalDuration)\n      }, {\n        label: '平均速度',\n        value: isNaN(avgSpeed) ? '0 km/h' : `${avgSpeed.toFixed(1)} km/h`\n      }, {\n        label: '数据点数',\n        value: totalPoints.value\n      }];\n    });\n\n    // 地图初始化\n    async function initMap() {\n      if (!window.AMap) {\n        await loadAMapAPI();\n      }\n      map = new window.AMap.Map(mapContainerId, {\n        center: [117.120, 36.651],\n        zoom: 10,\n        mapStyle: 'amap://styles/dark'\n      });\n      map.plugin(['AMap.ToolBar', 'AMap.Scale'], function () {\n        map.addControl(new window.AMap.ToolBar());\n        map.addControl(new window.AMap.Scale());\n      });\n    }\n\n    // 加载高德地图API\n    function loadAMapAPI() {\n      return new Promise((resolve, reject) => {\n        if (window.AMap) {\n          resolve();\n          return;\n        }\n        const script = document.createElement('script');\n        script.src = 'https://webapi.amap.com/maps?v=2.0&key=ac9b745946df9aee02cf0515319407df&callback=initAMap';\n        window.initAMap = () => {\n          resolve();\n          delete window.initAMap;\n        };\n        script.onerror = reject;\n        document.head.appendChild(script);\n      });\n    }\n\n    // 查询轨迹\n    async function queryTracks() {\n      if (!queryParams.value.vehicleId.trim()) {\n        alert('请输入车辆ID进行查询');\n        return;\n      }\n      loading.value = true;\n      try {\n        // 将ISO时间字符串转换为UTC时间戳\n        const startTimeStamp = new Date(queryParams.value.startTime).getTime() / 1000;\n        const endTimeStamp = new Date(queryParams.value.endTime).getTime() / 1000;\n        const params = {\n          start_time: startTimeStamp,\n          end_time: endTimeStamp,\n          vehicle_id: queryParams.value.vehicleId.trim(),\n          view_type: 'trajectory'\n        };\n        console.log('查询参数:', params);\n        console.log('转换前时间:', queryParams.value.startTime, queryParams.value.endTime);\n        console.log('转换后时间戳:', startTimeStamp, endTimeStamp);\n        const response = await getTrackData(params);\n        if (response.data.success && response.data.data) {\n          // 处理轨迹数据\n          processTrackData(response.data.data);\n          // 在地图上显示轨迹\n          displayTracksOnMap();\n        } else {\n          alert(response.data.message || '查询失败');\n        }\n      } catch (error) {\n        console.error('查询轨迹失败:', error);\n        alert('查询失败，请检查网络连接');\n      } finally {\n        loading.value = false;\n      }\n    }\n\n    // 处理轨迹数据\n    function processTrackData(data) {\n      if (!data || data.length === 0) {\n        trackData.value = [];\n        return;\n      }\n      console.log('原始轨迹数据:', data);\n\n      // 检查数据结构 - 后端返回的是VehicleTrack对象数组\n      if (data[0] && data[0].vehicle_id && data[0].points) {\n        // 如果是VehicleTrack对象数组，直接使用\n        trackData.value = data.map(track => ({\n          vehicle_id: track.vehicle_id,\n          points: track.points || [],\n          distance: track.distance || 0,\n          duration: track.end_time && track.start_time ? track.end_time - track.start_time : 0,\n          start_time: track.start_time,\n          end_time: track.end_time\n        }));\n      } else {\n        // 如果是原始数据点数组，按车辆ID分组处理\n        const vehicleGroups = {};\n        data.forEach(point => {\n          const vehicleId = point.vehicle_id;\n          if (!vehicleGroups[vehicleId]) {\n            vehicleGroups[vehicleId] = [];\n          }\n          vehicleGroups[vehicleId].push({\n            lng: point.longitude,\n            lat: point.latitude,\n            timestamp: point.UTC,\n            speed: point.speed || 0\n          });\n        });\n\n        // 计算每个车辆的轨迹统计\n        trackData.value = Object.keys(vehicleGroups).map(vehicleId => {\n          const points = vehicleGroups[vehicleId].sort((a, b) => a.timestamp - b.timestamp);\n\n          // 计算距离和时长\n          let distance = 0;\n          for (let i = 1; i < points.length; i++) {\n            distance += calculateDistance(points[i - 1], points[i]);\n          }\n          const duration = points.length > 0 ? points[points.length - 1].timestamp - points[0].timestamp : 0;\n          return {\n            vehicle_id: vehicleId,\n            points: points,\n            distance: distance,\n            duration: duration,\n            start_time: points[0]?.timestamp,\n            end_time: points[points.length - 1]?.timestamp\n          };\n        });\n      }\n      console.log('处理后的轨迹数据:', trackData.value);\n\n      // 确保数据格式正确\n      trackData.value.forEach(track => {\n        if (track.points && track.points.length > 0) {\n          console.log(`车辆 ${track.vehicle_id}: ${track.points.length} 个点, 距离: ${track.distance}km, 时长: ${track.duration}s`);\n        }\n      });\n    }\n\n    // 在地图上显示轨迹\n    function displayTracksOnMap() {\n      if (!map || trackData.value.length === 0) return;\n\n      // 清除现有轨迹\n      clearMap();\n      const colors = ['#ff4444', '#44ff44', '#4444ff', '#ffff44', '#ff44ff', '#44ffff'];\n      trackData.value.forEach((track, index) => {\n        if (!track.points || track.points.length < 2) {\n          console.log(`车辆 ${track.vehicle_id} 轨迹点不足，跳过显示`);\n          return;\n        }\n        const color = colors[index % colors.length];\n\n        // 构建轨迹路径，确保坐标格式正确\n        const path = track.points.map(point => {\n          // 适配不同的坐标格式\n          const lng = point.lng || point.longitude;\n          const lat = point.lat || point.latitude;\n          if (lng === undefined || lat === undefined) {\n            console.error('轨迹点缺少坐标信息:', point);\n            return null;\n          }\n          return [lng, lat];\n        }).filter(p => p !== null); // 过滤掉无效点\n\n        if (path.length < 2) {\n          console.log(`车辆 ${track.vehicle_id} 有效轨迹点不足，跳过显示`);\n          return;\n        }\n        console.log(`绘制车辆 ${track.vehicle_id} 轨迹，共 ${path.length} 个点`);\n        console.log('轨迹路径:', path.slice(0, 3), '...', path.slice(-3)); // 显示前3个和后3个点\n\n        // 创建轨迹线\n        const polyline = new window.AMap.Polyline({\n          path: path,\n          strokeColor: color,\n          strokeWeight: 4,\n          strokeOpacity: 0.8,\n          showDir: true,\n          lineJoin: 'round',\n          lineCap: 'round'\n        });\n        map.add(polyline);\n        polylines.push(polyline);\n\n        // 添加起点标记（绿色）\n        const startMarker = new window.AMap.Marker({\n          position: path[0],\n          icon: new window.AMap.Icon({\n            size: new window.AMap.Size(16, 16),\n            image: 'data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iMTYiIGhlaWdodD0iMTYiIHZpZXdCb3g9IjAgMCAxNiAxNiIgZmlsbD0ibm9uZSIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIj4KPGNpcmNsZSBjeD0iOCIgY3k9IjgiIHI9IjYiIGZpbGw9IiMwMGZmMDAiIHN0cm9rZT0iI2ZmZiIgc3Ryb2tlLXdpZHRoPSIyIi8+Cjwvc3ZnPgo='\n          }),\n          title: `起点 - ${track.vehicle_id}`,\n          zIndex: 100\n        });\n        map.add(startMarker);\n        markers.push(startMarker);\n\n        // 添加终点标记（红色）\n        const endMarker = new window.AMap.Marker({\n          position: path[path.length - 1],\n          icon: new window.AMap.Icon({\n            size: new window.AMap.Size(16, 16),\n            image: 'data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iMTYiIGhlaWdodD0iMTYiIHZpZXdCb3g9IjAgMCAxNiAxNiIgZmlsbD0ibm9uZSIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIj4KPGNpcmNsZSBjeD0iOCIgY3k9IjgiIHI9IjYiIGZpbGw9IiNmZjAwMDAiIHN0cm9rZT0iI2ZmZiIgc3Ryb2tlLXdpZHRoPSIyIi8+Cjwvc3ZnPgo='\n          }),\n          title: `终点 - ${track.vehicle_id}`,\n          zIndex: 100\n        });\n        map.add(endMarker);\n        markers.push(endMarker);\n      });\n\n      // 自动调整地图视野以显示所有轨迹\n      if (polylines.length > 0) {\n        try {\n          const bounds = new window.AMap.Bounds();\n          trackData.value.forEach(track => {\n            if (track.points && track.points.length > 0) {\n              track.points.forEach(point => {\n                const lng = point.lng || point.longitude;\n                const lat = point.lat || point.latitude;\n                if (lng !== undefined && lat !== undefined) {\n                  bounds.extend([lng, lat]);\n                }\n              });\n            }\n          });\n          if (!bounds.isEmpty()) {\n            map.setBounds(bounds, false, [50, 50, 50, 50]); // 添加边距\n          }\n        } catch (error) {\n          console.error('设置地图边界失败:', error);\n        }\n      }\n    }\n\n    // 清除地图\n    function clearMap() {\n      if (!map) return;\n      polylines.forEach(polyline => map.remove(polyline));\n      markers.forEach(marker => map.remove(marker));\n      polylines = [];\n      markers = [];\n    }\n\n    // 地图控制功能\n    function zoomIn() {\n      if (map) map.zoomIn();\n    }\n    function zoomOut() {\n      if (map) map.zoomOut();\n    }\n    function resetView() {\n      if (map && polylines.length > 0) {\n        map.setFitView([...polylines, ...markers]);\n      }\n    }\n\n    // 高亮轨迹\n    function highlightTrack(vehicleId) {\n      selectedTrackDetails.value = trackData.value.find(track => track.vehicle_id === vehicleId);\n    }\n\n    // 动画播放\n    function playAnimation() {\n      alert('动画播放功能开发中...');\n    }\n\n    // 导出轨迹\n    function exportTrack() {\n      if (trackData.value.length === 0) return;\n      const dataStr = JSON.stringify(trackData.value, null, 2);\n      const dataBlob = new Blob([dataStr], {\n        type: 'application/json'\n      });\n      const url = URL.createObjectURL(dataBlob);\n      const link = document.createElement('a');\n      link.href = url;\n      link.download = `track_data_${queryParams.value.vehicleId}_${Date.now()}.json`;\n      link.click();\n      URL.revokeObjectURL(url);\n    }\n\n    // 加载示例车辆\n    async function loadSampleVehicles() {\n      loadingSamples.value = true;\n      try {\n        // 将当前时间范围转换为时间戳\n        const startTimeStamp = new Date(queryParams.value.startTime).getTime() / 1000;\n        const endTimeStamp = new Date(queryParams.value.endTime).getTime() / 1000;\n        console.log('获取示例车辆，时间范围:', startTimeStamp, endTimeStamp);\n        const response = await getSampleVehicles(startTimeStamp, endTimeStamp, 20);\n        if (response.data.success && response.data.vehicles) {\n          sampleVehicles.value = response.data.vehicles;\n          console.log('获取到示例车辆:', sampleVehicles.value);\n        } else {\n          alert(response.data.message || '获取示例车辆失败');\n          sampleVehicles.value = [];\n        }\n      } catch (error) {\n        console.error('获取示例车辆失败:', error);\n        alert('获取示例车辆失败，请检查网络连接');\n        sampleVehicles.value = [];\n      } finally {\n        loadingSamples.value = false;\n      }\n    }\n\n    // 选择示例车辆\n    function selectSampleVehicle(vehicleId) {\n      if (vehicleId) {\n        queryParams.value.vehicleId = vehicleId;\n        console.log('选择了车辆:', vehicleId);\n      }\n    }\n\n    // 工具函数\n    function calculateDistance(point1, point2) {\n      const R = 6371; // 地球半径 km\n      const dLat = (point2.lat - point1.lat) * Math.PI / 180;\n      const dLon = (point2.lng - point1.lng) * Math.PI / 180;\n      const a = Math.sin(dLat / 2) * Math.sin(dLat / 2) + Math.cos(point1.lat * Math.PI / 180) * Math.cos(point2.lat * Math.PI / 180) * Math.sin(dLon / 2) * Math.sin(dLon / 2);\n      const c = 2 * Math.atan2(Math.sqrt(a), Math.sqrt(1 - a));\n      return R * c;\n    }\n    function formatDistance(distance) {\n      if (distance < 1) {\n        return `${(distance * 1000).toFixed(0)} m`;\n      }\n      return `${distance.toFixed(2)} km`;\n    }\n    function formatDuration(seconds) {\n      const hours = Math.floor(seconds / 3600);\n      const minutes = Math.floor(seconds % 3600 / 60);\n      const secs = seconds % 60;\n      if (hours > 0) {\n        return `${hours}h ${minutes}m ${secs}s`;\n      } else if (minutes > 0) {\n        return `${minutes}m ${secs}s`;\n      } else {\n        return `${secs}s`;\n      }\n    }\n    function formatTime(timestamp) {\n      return new Date(timestamp * 1000).toLocaleString('zh-CN');\n    }\n\n    // 生命周期\n    onMounted(() => {\n      setTimeout(() => {\n        initMap();\n      }, 500);\n    });\n    onUnmounted(() => {\n      if (map) {\n        map.destroy();\n      }\n    });\n    const __returned__ = {\n      loading,\n      loadingSamples,\n      trackData,\n      selectedTrackDetails,\n      sampleVehicles,\n      queryParams,\n      displayOptions,\n      mapContainerId,\n      get map() {\n        return map;\n      },\n      set map(v) {\n        map = v;\n      },\n      get polylines() {\n        return polylines;\n      },\n      set polylines(v) {\n        polylines = v;\n      },\n      get markers() {\n        return markers;\n      },\n      set markers(v) {\n        markers = v;\n      },\n      minDate,\n      maxDate,\n      totalPoints,\n      trackStats,\n      initMap,\n      loadAMapAPI,\n      queryTracks,\n      processTrackData,\n      displayTracksOnMap,\n      clearMap,\n      zoomIn,\n      zoomOut,\n      resetView,\n      highlightTrack,\n      playAnimation,\n      exportTrack,\n      loadSampleVehicles,\n      selectSampleVehicle,\n      calculateDistance,\n      formatDistance,\n      formatDuration,\n      formatTime,\n      ref,\n      computed,\n      onMounted,\n      onUnmounted,\n      get Route() {\n        return Route;\n      },\n      get Search() {\n        return Search;\n      },\n      get X() {\n        return X;\n      },\n      get Play() {\n        return Play;\n      },\n      get Download() {\n        return Download;\n      },\n      get getTrackData() {\n        return getTrackData;\n      },\n      get getSampleVehicles() {\n        return getSampleVehicles;\n      }\n    };\n    Object.defineProperty(__returned__, '__isScriptSetup', {\n      enumerable: false,\n      value: true\n    });\n    return __returned__;\n  }\n};","map":{"version":3,"names":["ref","computed","onMounted","onUnmounted","Route","Search","X","Play","Download","getTrackData","getSampleVehicles","minDate","maxDate","loading","loadingSamples","trackData","selectedTrackDetails","sampleVehicles","queryParams","startTime","endTime","vehicleId","mode","detail","speedFilter","displayOptions","showSpeed","showTime","showStops","mapContainerId","Date","now","map","polylines","markers","totalPoints","value","reduce","total","track","points","length","trackStats","totalDistance","sum","distance","totalDuration","duration","avgSpeed","label","formatDistance","formatDuration","isNaN","toFixed","initMap","window","AMap","loadAMapAPI","Map","center","zoom","mapStyle","plugin","addControl","ToolBar","Scale","Promise","resolve","reject","script","document","createElement","src","initAMap","onerror","head","appendChild","queryTracks","trim","alert","startTimeStamp","getTime","endTimeStamp","params","start_time","end_time","vehicle_id","view_type","console","log","response","data","success","processTrackData","displayTracksOnMap","message","error","vehicleGroups","forEach","point","push","lng","longitude","lat","latitude","timestamp","UTC","speed","Object","keys","sort","a","b","i","calculateDistance","clearMap","colors","index","color","path","undefined","filter","p","slice","polyline","Polyline","strokeColor","strokeWeight","strokeOpacity","showDir","lineJoin","lineCap","add","startMarker","Marker","position","icon","Icon","size","Size","image","title","zIndex","endMarker","bounds","Bounds","extend","isEmpty","setBounds","remove","marker","zoomIn","zoomOut","resetView","setFitView","highlightTrack","find","playAnimation","exportTrack","dataStr","JSON","stringify","dataBlob","Blob","type","url","URL","createObjectURL","link","href","download","click","revokeObjectURL","loadSampleVehicles","vehicles","selectSampleVehicle","point1","point2","R","dLat","Math","PI","dLon","sin","cos","c","atan2","sqrt","seconds","hours","floor","minutes","secs","formatTime","toLocaleString","setTimeout","destroy"],"sources":["E:/hhh/frontend/src/modules/trafficVisualization/TrafficTrack.vue"],"sourcesContent":["<template>\r\n  <div class=\"track-query-container\">\r\n    <!-- 查询控制面板 -->\r\n    <div class=\"card-tech p-6 mb-6\">\r\n      <h2 class=\"text-xl font-semibold text-white mb-4 flex items-center\">\r\n        <Route class=\"h-5 w-5 mr-2 text-cyan-400\" />\r\n        车辆轨迹查询\r\n      </h2>\r\n      \r\n      <!-- 查询表单 -->\r\n      <div class=\"grid grid-cols-1 md:grid-cols-3 gap-4 mb-4\">\r\n        <div class=\"space-y-2\">\r\n          <label class=\"text-sm text-blue-200\">起始时间</label>\r\n          <input \r\n            v-model=\"queryParams.startTime\"\r\n            type=\"datetime-local\" \r\n            class=\"input-tech\"\r\n            :min=\"minDate\"\r\n            :max=\"maxDate\"\r\n          />\r\n        </div>\r\n        <div class=\"space-y-2\">\r\n          <label class=\"text-sm text-blue-200\">结束时间</label>\r\n          <input \r\n            v-model=\"queryParams.endTime\"\r\n            type=\"datetime-local\" \r\n            class=\"input-tech\"\r\n            :min=\"minDate\"\r\n            :max=\"maxDate\"\r\n          />\r\n        </div>\r\n        <div class=\"space-y-2\">\r\n          <label class=\"text-sm text-blue-200\">车辆ID（精确查询）</label>\r\n          <div class=\"flex space-x-2\">\r\n            <input \r\n              v-model=\"queryParams.vehicleId\"\r\n              type=\"text\" \r\n              placeholder=\"输入具体车辆ID，如: 粤A12345\"\r\n              class=\"input-tech placeholder:text-blue-300 flex-1\"\r\n            />\r\n            <button \r\n              @click=\"loadSampleVehicles\"\r\n              :disabled=\"loadingSamples\"\r\n              class=\"btn-tech-small whitespace-nowrap\"\r\n            >\r\n              {{ loadingSamples ? '加载中...' : '获取示例' }}\r\n            </button>\r\n          </div>\r\n          <!-- 示例车辆下拉列表 -->\r\n          <div v-if=\"sampleVehicles.length > 0\" class=\"mt-2\">\r\n            <select \r\n              @change=\"selectSampleVehicle($event.target.value)\"\r\n              class=\"input-tech text-sm\"\r\n            >\r\n              <option value=\"\">选择示例车辆...</option>\r\n              <option \r\n                v-for=\"vehicle in sampleVehicles\" \r\n                :key=\"vehicle.vehicle_id\"\r\n                :value=\"vehicle.vehicle_id\"\r\n              >\r\n                {{ vehicle.description }}\r\n              </option>\r\n            </select>\r\n          </div>\r\n        </div>\r\n      </div>\r\n      \r\n      <!-- 查询选项 -->\r\n      <div class=\"grid grid-cols-1 md:grid-cols-4 gap-4 mb-4\">\r\n        <div class=\"space-y-2\">\r\n          <label class=\"text-sm text-blue-200\">查询模式</label>\r\n          <select v-model=\"queryParams.mode\" class=\"input-tech\">\r\n            <option value=\"single\">单车辆轨迹</option>\r\n            <option value=\"multiple\">多车辆对比</option>\r\n            <option value=\"area\">区域内所有车辆</option>\r\n          </select>\r\n        </div>\r\n        <div class=\"space-y-2\">\r\n          <label class=\"text-sm text-blue-200\">显示详细度</label>\r\n          <select v-model=\"queryParams.detail\" class=\"input-tech\">\r\n            <option value=\"full\">完整轨迹</option>\r\n            <option value=\"key\">关键节点</option>\r\n            <option value=\"simplified\">简化路径</option>\r\n          </select>\r\n        </div>\r\n        <div class=\"space-y-2\">\r\n          <label class=\"text-sm text-blue-200\">速度阈值</label>\r\n          <input \r\n            v-model=\"queryParams.speedFilter\"\r\n            type=\"number\" \r\n            placeholder=\"最低速度(km/h)\"\r\n            class=\"input-tech placeholder:text-blue-300\"\r\n          />\r\n        </div>\r\n        <div class=\"space-y-2\">\r\n          <label class=\"text-sm text-blue-200\">显示选项</label>\r\n          <div class=\"flex space-x-2\">\r\n            <label class=\"flex items-center text-xs text-blue-200\">\r\n              <input type=\"checkbox\" v-model=\"displayOptions.showSpeed\" class=\"mr-1\">\r\n              速度\r\n            </label>\r\n            <label class=\"flex items-center text-xs text-blue-200\">\r\n              <input type=\"checkbox\" v-model=\"displayOptions.showTime\" class=\"mr-1\">\r\n              时间\r\n            </label>\r\n            <label class=\"flex items-center text-xs text-blue-200\">\r\n              <input type=\"checkbox\" v-model=\"displayOptions.showStops\" class=\"mr-1\">\r\n              停留点\r\n            </label>\r\n          </div>\r\n        </div>\r\n      </div>\r\n      \r\n      <!-- 操作按钮 -->\r\n      <div class=\"flex space-x-4\">\r\n        <button \r\n          @click=\"queryTracks\"\r\n          :disabled=\"loading\"\r\n          class=\"btn-tech flex items-center text-white\"\r\n        >\r\n          <Search class=\"h-4 w-4 mr-2\" />\r\n          {{ loading ? '查询中...' : '查询轨迹' }}\r\n        </button>\r\n        <button \r\n          @click=\"clearMap\"\r\n          class=\"btn-tech-secondary flex items-center text-white\"\r\n        >\r\n          <X class=\"h-4 w-4 mr-2\" />\r\n          清除地图\r\n        </button>\r\n        <button \r\n          @click=\"playAnimation\"\r\n          :disabled=\"!trackData.length\"\r\n          class=\"btn-tech flex items-center text-white\"\r\n        >\r\n          <Play class=\"h-4 w-4 mr-2\" />\r\n          动画播放\r\n        </button>\r\n        <button \r\n          @click=\"exportTrack\"\r\n          :disabled=\"!trackData.length\"\r\n          class=\"btn-tech-secondary flex items-center text-white\"\r\n        >\r\n          <Download class=\"h-4 w-4 mr-2\" />\r\n          导出数据\r\n        </button>\r\n      </div>\r\n    </div>\r\n\r\n    <!-- 轨迹分析结果 -->\r\n    <div class=\"grid grid-cols-1 lg:grid-cols-3 gap-6 mb-6\">\r\n      <!-- 地图显示 -->\r\n      <div class=\"lg:col-span-2 card-tech p-6\">\r\n        <h3 class=\"text-lg font-semibold text-white mb-4\">轨迹地图</h3>\r\n        <div \r\n          :id=\"mapContainerId\" \r\n          class=\"w-full h-96 bg-gray-800 rounded-lg border border-blue-800\"\r\n        ></div>\r\n        \r\n        <!-- 地图控制 -->\r\n        <div class=\"flex justify-between items-center mt-4\">\r\n          <div class=\"flex space-x-2\">\r\n            <button @click=\"zoomIn\" class=\"btn-tech-small\">放大</button>\r\n            <button @click=\"zoomOut\" class=\"btn-tech-small\">缩小</button>\r\n            <button @click=\"resetView\" class=\"btn-tech-small\">重置视图</button>\r\n          </div>\r\n          <div class=\"text-sm text-blue-200\">\r\n            显示 {{ trackData.length }} 条轨迹，共 {{ totalPoints }} 个点\r\n          </div>\r\n        </div>\r\n      </div>\r\n      \r\n      <!-- 轨迹统计 -->\r\n      <div class=\"card-tech p-6\">\r\n        <h3 class=\"text-lg font-semibold text-white mb-4\">轨迹分析</h3>\r\n        <div class=\"space-y-4\">\r\n          <div v-for=\"stat in trackStats\" :key=\"stat.label\" class=\"flex justify-between\">\r\n            <span class=\"text-blue-200\">{{ stat.label }}</span>\r\n            <span class=\"text-white font-semibold\">{{ stat.value }}</span>\r\n          </div>\r\n        </div>\r\n        \r\n        <!-- 车辆列表 -->\r\n        <div class=\"mt-6\" v-if=\"trackData.length > 0\">\r\n          <h4 class=\"text-sm font-semibold text-blue-200 mb-2\">车辆列表</h4>\r\n          <div class=\"max-h-48 overflow-y-auto space-y-2\">\r\n            <div \r\n              v-for=\"track in trackData\" \r\n              :key=\"track.vehicle_id\"\r\n              @click=\"highlightTrack(track.vehicle_id)\"\r\n              class=\"p-2 bg-gray-700 rounded cursor-pointer hover:bg-gray-600 transition-colors\"\r\n            >\r\n              <div class=\"flex justify-between items-center\">\r\n                <span class=\"text-white text-sm\">{{ track.vehicle_id }}</span>\r\n                <span class=\"text-xs text-blue-300\">{{ formatDistance(track.distance) }}</span>\r\n              </div>\r\n              <div class=\"text-xs text-gray-400\">\r\n                {{ formatDuration(track.duration) }}\r\n              </div>\r\n            </div>\r\n          </div>\r\n        </div>\r\n      </div>\r\n    </div>\r\n\r\n    <!-- 轨迹详情表格 -->\r\n    <div class=\"card-tech p-6\" v-if=\"selectedTrackDetails\">\r\n      <h3 class=\"text-lg font-semibold text-white mb-4\">轨迹详情 - {{ selectedTrackDetails.vehicle_id }}</h3>\r\n      <div class=\"overflow-x-auto\">\r\n        <table class=\"w-full text-sm\">\r\n          <thead>\r\n            <tr class=\"border-b border-gray-600\">\r\n              <th class=\"text-left py-2 text-blue-200\">时间</th>\r\n              <th class=\"text-left py-2 text-blue-200\">经度</th>\r\n              <th class=\"text-left py-2 text-blue-200\">纬度</th>\r\n              <th class=\"text-left py-2 text-blue-200\">速度</th>\r\n              <th class=\"text-left py-2 text-blue-200\">方向</th>\r\n              <th class=\"text-left py-2 text-blue-200\">状态</th>\r\n            </tr>\r\n          </thead>\r\n          <tbody>\r\n            <tr \r\n              v-for=\"(point, index) in selectedTrackDetails.points\" \r\n              :key=\"index\"\r\n              class=\"border-b border-gray-700 hover:bg-gray-700\"\r\n            >\r\n              <td class=\"py-2 text-white\">{{ formatTime(point.timestamp) }}</td>\r\n              <td class=\"py-2 text-white\">{{ point.lng.toFixed(6) }}</td>\r\n              <td class=\"py-2 text-white\">{{ point.lat.toFixed(6) }}</td>\r\n              <td class=\"py-2 text-white\">{{ point.speed || 'N/A' }}</td>\r\n              <td class=\"py-2 text-white\">{{ point.direction || 'N/A' }}</td>\r\n              <td class=\"py-2 text-white\">{{ point.status || 'N/A' }}</td>\r\n            </tr>\r\n          </tbody>\r\n        </table>\r\n      </div>\r\n    </div>\r\n\r\n    <!-- 加载状态 -->\r\n    <div v-if=\"loading\" class=\"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50\">\r\n      <div class=\"bg-blue-900 p-6 rounded-lg text-white\">\r\n        <div class=\"flex items-center\">\r\n          <div class=\"animate-spin rounded-full h-6 w-6 border-t-2 border-b-2 border-cyan-400 mr-3\"></div>\r\n          <span>正在查询轨迹数据...</span>\r\n        </div>\r\n      </div>\r\n    </div>\r\n  </div>\r\n</template>\r\n\r\n<script setup>\r\nimport { ref, computed, onMounted, onUnmounted } from 'vue'\r\nimport { Route, Search, X, Play, Download } from 'lucide-vue-next'\r\nimport { getTrackData, getSampleVehicles } from '@/api/traffic'\r\n\r\n// 响应式数据\r\nconst loading = ref(false)\r\nconst loadingSamples = ref(false)\r\nconst trackData = ref([])\r\nconst selectedTrackDetails = ref(null)\r\nconst sampleVehicles = ref([])\r\n\r\nconst queryParams = ref({\r\n  startTime: '2013-09-13T08:00',\r\n  endTime: '2013-09-13T12:00',\r\n  vehicleId: '',\r\n  mode: 'single',\r\n  detail: 'full',\r\n  speedFilter: ''\r\n})\r\n\r\nconst displayOptions = ref({\r\n  showSpeed: true,\r\n  showTime: true,\r\n  showStops: false\r\n})\r\n\r\n// 地图相关\r\nconst mapContainerId = `track-map-${Date.now()}`\r\nlet map = null\r\nlet polylines = []\r\nlet markers = []\r\n\r\n// 时间限制\r\nconst minDate = \"2013-09-12T00:00\"\r\nconst maxDate = \"2013-09-18T23:59\"\r\n\r\n// 计算属性\r\nconst totalPoints = computed(() => {\r\n  return trackData.value.reduce((total, track) => {\r\n    return total + (track.points ? track.points.length : 0)\r\n  }, 0)\r\n})\r\n\r\nconst trackStats = computed(() => {\r\n  if (trackData.value.length === 0) return []\r\n  \r\n  // 计算总距离和总时长\r\n  const totalDistance = trackData.value.reduce((sum, track) => {\r\n    // 使用后端计算的距离（单位：公里）\r\n    const distance = track.distance || 0\r\n    return sum + distance\r\n  }, 0)\r\n  \r\n  const totalDuration = trackData.value.reduce((sum, track) => {\r\n    // 使用后端计算的时长（单位：秒）\r\n    const duration = track.duration || 0\r\n    return sum + duration\r\n  }, 0)\r\n  \r\n  // 计算平均速度 (km/h)\r\n  const avgSpeed = totalDuration > 0 ? (totalDistance / (totalDuration / 3600)) : 0\r\n  \r\n  return [\r\n    { label: '轨迹数量', value: trackData.value.length },\r\n    { label: '总距离', value: formatDistance(totalDistance) },\r\n    { label: '总时长', value: formatDuration(totalDuration) },\r\n    { label: '平均速度', value: isNaN(avgSpeed) ? '0 km/h' : `${avgSpeed.toFixed(1)} km/h` },\r\n    { label: '数据点数', value: totalPoints.value }\r\n  ]\r\n})\r\n\r\n// 地图初始化\r\nasync function initMap() {\r\n  if (!window.AMap) {\r\n    await loadAMapAPI()\r\n  }\r\n  \r\n  map = new window.AMap.Map(mapContainerId, {\r\n    center: [117.120, 36.651],\r\n    zoom: 10,\r\n    mapStyle: 'amap://styles/dark'\r\n  })\r\n  \r\n  map.plugin(['AMap.ToolBar', 'AMap.Scale'], function() {\r\n    map.addControl(new window.AMap.ToolBar())\r\n    map.addControl(new window.AMap.Scale())\r\n  })\r\n}\r\n\r\n// 加载高德地图API\r\nfunction loadAMapAPI() {\r\n  return new Promise((resolve, reject) => {\r\n    if (window.AMap) {\r\n      resolve()\r\n      return\r\n    }\r\n    \r\n    const script = document.createElement('script')\r\n    script.src = 'https://webapi.amap.com/maps?v=2.0&key=ac9b745946df9aee02cf0515319407df&callback=initAMap'\r\n    \r\n    window.initAMap = () => {\r\n      resolve()\r\n      delete window.initAMap\r\n    }\r\n    \r\n    script.onerror = reject\r\n    document.head.appendChild(script)\r\n  })\r\n}\r\n\r\n// 查询轨迹\r\nasync function queryTracks() {\r\n  if (!queryParams.value.vehicleId.trim()) {\r\n    alert('请输入车辆ID进行查询')\r\n    return\r\n  }\r\n  \r\n  loading.value = true\r\n  \r\n  try {\r\n    // 将ISO时间字符串转换为UTC时间戳\r\n    const startTimeStamp = new Date(queryParams.value.startTime).getTime() / 1000\r\n    const endTimeStamp = new Date(queryParams.value.endTime).getTime() / 1000\r\n    \r\n    const params = {\r\n      start_time: startTimeStamp,\r\n      end_time: endTimeStamp,\r\n      vehicle_id: queryParams.value.vehicleId.trim(),\r\n      view_type: 'trajectory'\r\n    }\r\n    \r\n    console.log('查询参数:', params)\r\n    console.log('转换前时间:', queryParams.value.startTime, queryParams.value.endTime)\r\n    console.log('转换后时间戳:', startTimeStamp, endTimeStamp)\r\n    \r\n    const response = await getTrackData(params)\r\n    \r\n    if (response.data.success && response.data.data) {\r\n      // 处理轨迹数据\r\n      processTrackData(response.data.data)\r\n      // 在地图上显示轨迹\r\n      displayTracksOnMap()\r\n    } else {\r\n      alert(response.data.message || '查询失败')\r\n    }\r\n  } catch (error) {\r\n    console.error('查询轨迹失败:', error)\r\n    alert('查询失败，请检查网络连接')\r\n  } finally {\r\n    loading.value = false\r\n  }\r\n}\r\n\r\n// 处理轨迹数据\r\nfunction processTrackData(data) {\r\n  if (!data || data.length === 0) {\r\n    trackData.value = []\r\n    return\r\n  }\r\n  \r\n  console.log('原始轨迹数据:', data)\r\n  \r\n  // 检查数据结构 - 后端返回的是VehicleTrack对象数组\r\n  if (data[0] && data[0].vehicle_id && data[0].points) {\r\n    // 如果是VehicleTrack对象数组，直接使用\r\n    trackData.value = data.map(track => ({\r\n      vehicle_id: track.vehicle_id,\r\n      points: track.points || [],\r\n      distance: track.distance || 0,\r\n      duration: track.end_time && track.start_time ? track.end_time - track.start_time : 0,\r\n      start_time: track.start_time,\r\n      end_time: track.end_time\r\n    }))\r\n  } else {\r\n    // 如果是原始数据点数组，按车辆ID分组处理\r\n    const vehicleGroups = {}\r\n    data.forEach(point => {\r\n      const vehicleId = point.vehicle_id\r\n      if (!vehicleGroups[vehicleId]) {\r\n        vehicleGroups[vehicleId] = []\r\n      }\r\n      vehicleGroups[vehicleId].push({\r\n        lng: point.longitude,\r\n        lat: point.latitude,\r\n        timestamp: point.UTC,\r\n        speed: point.speed || 0\r\n      })\r\n    })\r\n    \r\n    // 计算每个车辆的轨迹统计\r\n    trackData.value = Object.keys(vehicleGroups).map(vehicleId => {\r\n      const points = vehicleGroups[vehicleId].sort((a, b) => a.timestamp - b.timestamp)\r\n      \r\n      // 计算距离和时长\r\n      let distance = 0\r\n      for (let i = 1; i < points.length; i++) {\r\n        distance += calculateDistance(points[i-1], points[i])\r\n      }\r\n      \r\n      const duration = points.length > 0 ? points[points.length - 1].timestamp - points[0].timestamp : 0\r\n      \r\n      return {\r\n        vehicle_id: vehicleId,\r\n        points: points,\r\n        distance: distance,\r\n        duration: duration,\r\n        start_time: points[0]?.timestamp,\r\n        end_time: points[points.length - 1]?.timestamp\r\n      }\r\n    })\r\n  }\r\n  \r\n  console.log('处理后的轨迹数据:', trackData.value)\r\n  \r\n  // 确保数据格式正确\r\n  trackData.value.forEach(track => {\r\n    if (track.points && track.points.length > 0) {\r\n      console.log(`车辆 ${track.vehicle_id}: ${track.points.length} 个点, 距离: ${track.distance}km, 时长: ${track.duration}s`)\r\n    }\r\n  })\r\n}\r\n\r\n// 在地图上显示轨迹\r\nfunction displayTracksOnMap() {\r\n  if (!map || trackData.value.length === 0) return\r\n  \r\n  // 清除现有轨迹\r\n  clearMap()\r\n  \r\n  const colors = ['#ff4444', '#44ff44', '#4444ff', '#ffff44', '#ff44ff', '#44ffff']\r\n  \r\n  trackData.value.forEach((track, index) => {\r\n    if (!track.points || track.points.length < 2) {\r\n      console.log(`车辆 ${track.vehicle_id} 轨迹点不足，跳过显示`)\r\n      return\r\n    }\r\n    \r\n    const color = colors[index % colors.length]\r\n    \r\n    // 构建轨迹路径，确保坐标格式正确\r\n    const path = track.points.map(point => {\r\n      // 适配不同的坐标格式\r\n      const lng = point.lng || point.longitude\r\n      const lat = point.lat || point.latitude\r\n      \r\n      if (lng === undefined || lat === undefined) {\r\n        console.error('轨迹点缺少坐标信息:', point)\r\n        return null\r\n      }\r\n      \r\n      return [lng, lat]\r\n    }).filter(p => p !== null)  // 过滤掉无效点\r\n    \r\n    if (path.length < 2) {\r\n      console.log(`车辆 ${track.vehicle_id} 有效轨迹点不足，跳过显示`)\r\n      return\r\n    }\r\n    \r\n    console.log(`绘制车辆 ${track.vehicle_id} 轨迹，共 ${path.length} 个点`)\r\n    console.log('轨迹路径:', path.slice(0, 3), '...', path.slice(-3))  // 显示前3个和后3个点\r\n    \r\n    // 创建轨迹线\r\n    const polyline = new window.AMap.Polyline({\r\n      path: path,\r\n      strokeColor: color,\r\n      strokeWeight: 4,\r\n      strokeOpacity: 0.8,\r\n      showDir: true,\r\n      lineJoin: 'round',\r\n      lineCap: 'round'\r\n    })\r\n    \r\n    map.add(polyline)\r\n    polylines.push(polyline)\r\n    \r\n    // 添加起点标记（绿色）\r\n    const startMarker = new window.AMap.Marker({\r\n      position: path[0],\r\n      icon: new window.AMap.Icon({\r\n        size: new window.AMap.Size(16, 16),\r\n        image: 'data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iMTYiIGhlaWdodD0iMTYiIHZpZXdCb3g9IjAgMCAxNiAxNiIgZmlsbD0ibm9uZSIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIj4KPGNpcmNsZSBjeD0iOCIgY3k9IjgiIHI9IjYiIGZpbGw9IiMwMGZmMDAiIHN0cm9rZT0iI2ZmZiIgc3Ryb2tlLXdpZHRoPSIyIi8+Cjwvc3ZnPgo='\r\n      }),\r\n      title: `起点 - ${track.vehicle_id}`,\r\n      zIndex: 100\r\n    })\r\n    \r\n    map.add(startMarker)\r\n    markers.push(startMarker)\r\n    \r\n    // 添加终点标记（红色）\r\n    const endMarker = new window.AMap.Marker({\r\n      position: path[path.length - 1],\r\n      icon: new window.AMap.Icon({\r\n        size: new window.AMap.Size(16, 16),\r\n        image: 'data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iMTYiIGhlaWdodD0iMTYiIHZpZXdCb3g9IjAgMCAxNiAxNiIgZmlsbD0ibm9uZSIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIj4KPGNpcmNsZSBjeD0iOCIgY3k9IjgiIHI9IjYiIGZpbGw9IiNmZjAwMDAiIHN0cm9rZT0iI2ZmZiIgc3Ryb2tlLXdpZHRoPSIyIi8+Cjwvc3ZnPgo='\r\n      }),\r\n      title: `终点 - ${track.vehicle_id}`,\r\n      zIndex: 100\r\n    })\r\n    \r\n    map.add(endMarker)\r\n    markers.push(endMarker)\r\n  })\r\n  \r\n  // 自动调整地图视野以显示所有轨迹\r\n  if (polylines.length > 0) {\r\n    try {\r\n      const bounds = new window.AMap.Bounds()\r\n      \r\n      trackData.value.forEach(track => {\r\n        if (track.points && track.points.length > 0) {\r\n          track.points.forEach(point => {\r\n            const lng = point.lng || point.longitude\r\n            const lat = point.lat || point.latitude\r\n            if (lng !== undefined && lat !== undefined) {\r\n              bounds.extend([lng, lat])\r\n            }\r\n          })\r\n        }\r\n      })\r\n      \r\n      if (!bounds.isEmpty()) {\r\n        map.setBounds(bounds, false, [50, 50, 50, 50])  // 添加边距\r\n      }\r\n    } catch (error) {\r\n      console.error('设置地图边界失败:', error)\r\n    }\r\n  }\r\n}\r\n\r\n// 清除地图\r\nfunction clearMap() {\r\n  if (!map) return\r\n  \r\n  polylines.forEach(polyline => map.remove(polyline))\r\n  markers.forEach(marker => map.remove(marker))\r\n  polylines = []\r\n  markers = []\r\n}\r\n\r\n// 地图控制功能\r\nfunction zoomIn() {\r\n  if (map) map.zoomIn()\r\n}\r\n\r\nfunction zoomOut() {\r\n  if (map) map.zoomOut()\r\n}\r\n\r\nfunction resetView() {\r\n  if (map && polylines.length > 0) {\r\n    map.setFitView([...polylines, ...markers])\r\n  }\r\n}\r\n\r\n// 高亮轨迹\r\nfunction highlightTrack(vehicleId) {\r\n  selectedTrackDetails.value = trackData.value.find(track => track.vehicle_id === vehicleId)\r\n}\r\n\r\n// 动画播放\r\nfunction playAnimation() {\r\n  alert('动画播放功能开发中...')\r\n}\r\n\r\n// 导出轨迹\r\nfunction exportTrack() {\r\n  if (trackData.value.length === 0) return\r\n  \r\n  const dataStr = JSON.stringify(trackData.value, null, 2)\r\n  const dataBlob = new Blob([dataStr], {type: 'application/json'})\r\n  const url = URL.createObjectURL(dataBlob)\r\n  \r\n  const link = document.createElement('a')\r\n  link.href = url\r\n  link.download = `track_data_${queryParams.value.vehicleId}_${Date.now()}.json`\r\n  link.click()\r\n  \r\n  URL.revokeObjectURL(url)\r\n}\r\n\r\n// 加载示例车辆\r\nasync function loadSampleVehicles() {\r\n  loadingSamples.value = true\r\n  \r\n  try {\r\n    // 将当前时间范围转换为时间戳\r\n    const startTimeStamp = new Date(queryParams.value.startTime).getTime() / 1000\r\n    const endTimeStamp = new Date(queryParams.value.endTime).getTime() / 1000\r\n    \r\n    console.log('获取示例车辆，时间范围:', startTimeStamp, endTimeStamp)\r\n    \r\n    const response = await getSampleVehicles(startTimeStamp, endTimeStamp, 20)\r\n    \r\n    if (response.data.success && response.data.vehicles) {\r\n      sampleVehicles.value = response.data.vehicles\r\n      console.log('获取到示例车辆:', sampleVehicles.value)\r\n    } else {\r\n      alert(response.data.message || '获取示例车辆失败')\r\n      sampleVehicles.value = []\r\n    }\r\n  } catch (error) {\r\n    console.error('获取示例车辆失败:', error)\r\n    alert('获取示例车辆失败，请检查网络连接')\r\n    sampleVehicles.value = []\r\n  } finally {\r\n    loadingSamples.value = false\r\n  }\r\n}\r\n\r\n// 选择示例车辆\r\nfunction selectSampleVehicle(vehicleId) {\r\n  if (vehicleId) {\r\n    queryParams.value.vehicleId = vehicleId\r\n    console.log('选择了车辆:', vehicleId)\r\n  }\r\n}\r\n\r\n// 工具函数\r\nfunction calculateDistance(point1, point2) {\r\n  const R = 6371 // 地球半径 km\r\n  const dLat = (point2.lat - point1.lat) * Math.PI / 180\r\n  const dLon = (point2.lng - point1.lng) * Math.PI / 180\r\n  const a = Math.sin(dLat/2) * Math.sin(dLat/2) + \r\n            Math.cos(point1.lat * Math.PI / 180) * Math.cos(point2.lat * Math.PI / 180) * \r\n            Math.sin(dLon/2) * Math.sin(dLon/2)\r\n  const c = 2 * Math.atan2(Math.sqrt(a), Math.sqrt(1-a))\r\n  return R * c\r\n}\r\n\r\nfunction formatDistance(distance) {\r\n  if (distance < 1) {\r\n    return `${(distance * 1000).toFixed(0)} m`\r\n  }\r\n  return `${distance.toFixed(2)} km`\r\n}\r\n\r\nfunction formatDuration(seconds) {\r\n  const hours = Math.floor(seconds / 3600)\r\n  const minutes = Math.floor((seconds % 3600) / 60)\r\n  const secs = seconds % 60\r\n  \r\n  if (hours > 0) {\r\n    return `${hours}h ${minutes}m ${secs}s`\r\n  } else if (minutes > 0) {\r\n    return `${minutes}m ${secs}s`\r\n  } else {\r\n    return `${secs}s`\r\n  }\r\n}\r\n\r\nfunction formatTime(timestamp) {\r\n  return new Date(timestamp * 1000).toLocaleString('zh-CN')\r\n}\r\n\r\n// 生命周期\r\nonMounted(() => {\r\n  setTimeout(() => {\r\n    initMap()\r\n  }, 500)\r\n})\r\n\r\nonUnmounted(() => {\r\n  if (map) {\r\n    map.destroy()\r\n  }\r\n})\r\n</script> \r\n\r\n<style scoped>\r\n.track-query-container {\r\n  padding: 20px;\r\n}\r\n\r\n.input-tech {\r\n  width: 100%;\r\n  padding: 8px 12px;\r\n  background: rgba(30, 58, 138, 0.3);\r\n  border: 1px solid rgba(59, 130, 246, 0.5);\r\n  border-radius: 6px;\r\n  color: white;\r\n  font-size: 14px;\r\n}\r\n\r\n.input-tech:focus {\r\n  outline: none;\r\n  border-color: #06b6d4;\r\n  box-shadow: 0 0 0 2px rgba(6, 182, 212, 0.2);\r\n}\r\n\r\n.btn-tech {\r\n  padding: 8px 16px;\r\n  background: linear-gradient(135deg, #0ea5e9, #06b6d4);\r\n  border: none;\r\n  border-radius: 6px;\r\n  color: white;\r\n  font-weight: 500;\r\n  cursor: pointer;\r\n  transition: all 0.3s ease;\r\n}\r\n\r\n.btn-tech:hover {\r\n  transform: translateY(-1px);\r\n  box-shadow: 0 4px 12px rgba(6, 182, 212, 0.4);\r\n}\r\n\r\n.btn-tech:disabled {\r\n  opacity: 0.5;\r\n  cursor: not-allowed;\r\n  transform: none;\r\n}\r\n\r\n.btn-tech-secondary {\r\n  padding: 8px 16px;\r\n  background: rgba(75, 85, 99, 0.8);\r\n  border: 1px solid rgba(156, 163, 175, 0.3);\r\n  border-radius: 6px;\r\n  color: white;\r\n  font-weight: 500;\r\n  cursor: pointer;\r\n  transition: all 0.3s ease;\r\n}\r\n\r\n.btn-tech-secondary:hover {\r\n  background: rgba(107, 114, 128, 0.8);\r\n}\r\n\r\n.btn-tech-small {\r\n  padding: 4px 8px;\r\n  font-size: 12px;\r\n  background: rgba(30, 58, 138, 0.8);\r\n  border: 1px solid rgba(59, 130, 246, 0.5);\r\n  border-radius: 4px;\r\n  color: white;\r\n  cursor: pointer;\r\n  transition: all 0.3s ease;\r\n}\r\n\r\n.btn-tech-small:hover {\r\n  background: rgba(37, 99, 235, 0.8);\r\n}\r\n\r\n.card-tech {\r\n  background: linear-gradient(135deg, rgba(30, 58, 138, 0.8), rgba(29, 78, 216, 0.6));\r\n  backdrop-filter: blur(10px);\r\n  border: 1px solid rgba(59, 130, 246, 0.2);\r\n  border-radius: 12px;\r\n  box-shadow: 0 8px 32px rgba(0, 0, 0, 0.3);\r\n}\r\n</style> "],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}